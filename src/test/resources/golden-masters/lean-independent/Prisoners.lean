/- Generated by Vegas Lean Encoder - Policy: INDEPENDENT -/

set_option autoImplicit false

/-- Hidden value with commitment semantics -/
structure Hidden (A : Type) where
  val : A

def Hidden.reveal {A : Type} (h : Hidden A) : A := h.val

/-- Game roles -/
inductive Role : Type where
  | A : Role
  | B : Role

/- Liveness Primitives -/
inductive Absence (r : Role) : Type where
  | timeout : Absence r

inductive Maybe (r : Role) (A : Type) : Type where
  | present : A → Maybe r A
  | absent : Absence r → Maybe r A

def Maybe.isPresent {r : Role} {A : Type} : Maybe r A → Prop
  | .present _ => True
  | .absent _ => False

def Maybe.getPresent {r : Role} {A : Type} (u : Maybe r A) (h : u.isPresent) : A :=
  match u with
  | .present a => a
  | .absent _ => False.elim h

/-- Extract value from wrapper, returning Option -/
def Maybe.getVal {r : Role} {A B : Type} (u : Maybe r A) (f : A → B) : Option B :=
  match u with
  | .present w => some (f w)
  | .absent _ => none

/-- Lift unary function over Option -/
def lift1 {A B : Type} (f : A → B) : Option A → Option B
  | some v => some (f v)
  | none => none

/-- Lift binary function over Option -/
def lift2 {A B C : Type} (f : A → B → C) : Option A → Option B → Option C
  | some vx, some vy => some (f vx vy)
  | _, _ => none

namespace GameProtocol

structure W0 : Type where

structure W1
    (w0 : Maybe Role.A (W0))
    : Type where

structure W2
    (w0 : Maybe Role.A (W0))
    (w1 : Maybe Role.B (W1 w0))
    : Type where
  hidden_c_A : Hidden Bool

structure W3
    (w0 : Maybe Role.A (W0))
    (w1 : Maybe Role.B (W1 w0))
    : Type where
  hidden_c_B : Hidden Bool

structure W4
    (w0 : Maybe Role.A (W0))
    (w1 : Maybe Role.B (W1 w0))
    (w2 : Maybe Role.A (W2 w0 w1))
    (w3 : Maybe Role.B (W3 w0 w1))
    : Type where
  c_A : Bool
  W4_guard_w2_present : w2.isPresent
  W4_guard_reveal_c_A : c_A = (w2.getPresent W4_guard_w2_present).hidden_c_A.reveal

structure W5
    (w0 : Maybe Role.A (W0))
    (w1 : Maybe Role.B (W1 w0))
    (w2 : Maybe Role.A (W2 w0 w1))
    (w3 : Maybe Role.B (W3 w0 w1))
    : Type where
  c_B : Bool
  W5_guard_w3_present : w3.isPresent
  W5_guard_reveal_c_B : c_B = (w3.getPresent W5_guard_w3_present).hidden_c_B.reveal

structure EventDag : Type where
  event0 : Maybe Role.A (W0)
  event1 : Maybe Role.B (W1 event0)
  event2 : Maybe Role.A (W2 event0 event1)
  event3 : Maybe Role.B (W3 event0 event1)
  event4 : Maybe Role.A (W4 event0 event1 event2 event3)
  event5 : Maybe Role.B (W5 event0 event1 event2 event3)

end GameProtocol
